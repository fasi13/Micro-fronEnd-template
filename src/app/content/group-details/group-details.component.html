<div class="fge-group--title row">
  <h4 class="my-2 col-10">
    <span *ngIf="loading$ | async" class="fas fa-circle-notch fa-spin"></span>
    {{ currentGroup?.name }}
    <button
      *ngIf="!(loading$ | async)"
      type="button"
      class="btn btn-sm btn-secondary bg-secondary"
      [ngClass]="{'btn-link': !editMode, 'btn-primary bg-primary': editMode}"
      (click)="toggleEditMode()"
    >
    Edit
    <span class="fas fa-edit pl-1"></span>
    </button>
  </h4>
  <div class="col text-right align-self-center">
    <button
      type="button"
      class="btn btn-sm btn-secondary bg-secondary"
      (click)="openContentForm()">
      Add Content
      <span class="fas fa-folder-plus fa-lg pl-1"></span>
    </button>
  </div>
</div>

<div *ngIf="editMode; then editView; else tableView"></div>

<ng-template #editView>
  <div *ngIf="contentsAsList?.length > 0" class="row fge-group--container-values mx-1 my-2 pb-0">
    <table class="table table-hover fge-table" *ngIf="contentsAsList && contentsAsList?.length > 0">
      <thead class="fge-table__header">
        <tr>
          <th scope="col fge-table__col">Name</th>
          <th scope="col fge-table__col">Description</th>
          <th scope="col fge-table__col">Status</th>
          <th scope="col fge-table__col">Publish Date</th>
          <th scope="col fge-table__col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let content of contentsAsList">
          <td>{{ content?.name }}</td>
          <td>{{ content?.description }}</td>
          <td>{{ content?.status }}</td>
          <td>{{ content?.publishDate | date:'medium' }}</td>
          <td>
            <a
              tabindex="0"
              (click)="goToContentEdit(content?.id)"
              class="btn btn-secondary bg-secondary btn-sm mr-2">
              <i class="far fa-edit"></i>
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="row fge-group--container-values mx-1 my-2" *ngIf="editableContents?.length > 0">
    <div class="col-xs-12 col-sm-12 col-md-8">
      <fge-content-inline-editor *ngFor="let content of editableContents"
        [contentData]="content?.contentData"
        [config]="content?.config">
      </fge-content-inline-editor>
    </div>
    <div class="col-md-5 fge-border-left" [ngClass]="{'fge-border-none': !adaContent}" [innerHTML]="adaContent"></div>
  </div>
</ng-template>

<ng-template #tableView>
  <table class="table fge-table">
    <thead class="fge-table__header">
      <tr>
        <th scope="col fge-table__col">Name</th>
        <th scope="col fge-table__col">Description</th>
        <th scope="col fge-table__col">Type</th>
        <th scope="col fge-table__col">Value</th>
        <th scope="col fge-table__col">Version</th>
        <th scope="col fge-table__col">Status</th>
        <th scope="col fge-table__col">Publish Date</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let content of currentGroup?.content">
        <td>{{ content?.name }}</td>
        <td>{{ content?.description }}</td>
        <td>{{ content?.dataType?.name }}</td>
        <td [ngSwitch]="content?.dataType?.name">
          <fge-content-type-color *ngSwitchCase="'Color Picker'" [value]="content?.value"></fge-content-type-color>
          <fge-content-type-text *ngSwitchCase="'Text'" [value]="content?.value"></fge-content-type-text>
          <fge-content-type-html *ngSwitchCase="'HTML'" [value]="content?.value"></fge-content-type-html>
          <fge-content-type-image *ngSwitchCase="'Image'" [value]="content?.value"></fge-content-type-image>
          <fge-content-type-logo *ngSwitchCase="'Logo Display'" [value]="content?.value"></fge-content-type-logo>
          <fge-content-type-document *ngSwitchCase="'Document'" [value]="content?.value"></fge-content-type-document>
        </td>
        <td>v{{content.currentVersion}}</td>
        <td>{{ content?.status }}</td>
        <td>{{ content.publishDate | date:'medium' }}</td>
      </tr>
    </tbody>
  </table>
</ng-template>
