<div class="fge-group--title row">
  <h3 class="fge-group--title-divider my-2 col-10">
    <i *ngIf="reportsState?.loading" class="fas fa-circle-notch fa-spin"></i
    ><span class="pl-2">Reports</span>
  </h3>
  <div class="col text-right align-self-center">
    <button
      type="button"
      class="btn btn-sm btn-secondary bg-secondary"
      (click)="exportReports()"
      title="Click to export">
      Export
      <i class="far fa-file-excel pl-1"></i>
    </button>
  </div>
</div>
<div class="fge-group--subtitle row">
  <h4 class="fge-group--title-divider my-2 col-10">
    <span class="pl-2">Audit Reports</span>
  </h4>
</div>  
<div class="row m-0">
  <div class="col fge-table__col border-bottom-0 pt-0 border-top-0">
    <ng-container
      [ngTemplateOutlet]="filterInput"
      [ngTemplateOutletContext]="{ label: 'Username', field: 'login' }"
    >
    </ng-container>
  </div>
  <div class="col fge-table__col border-bottom-0 pt-0 border-top-0">
    <ng-container
      [ngTemplateOutlet]="filterInput"
      [ngTemplateOutletContext]="{ label: 'First Name', field: 'firstName' }"
    >
    </ng-container>
  </div>
  <div class="col fge-table__col border-bottom-0 pt-0 border-top-0">
    <ng-container
      [ngTemplateOutlet]="filterInput"
      [ngTemplateOutletContext]="{ label: 'Last Name', field: 'lastName' }"
    >
    </ng-container>
  </div>
  <div class="col-2 fge-table__col border-bottom-0 pt-0 border-top-0">
    <ng-container
      [ngTemplateOutlet]="filterInput"
      [ngTemplateOutletContext]="{ label: 'Application', field: 'application' }"
    >
    </ng-container>
  </div>
  <div class="col-2 fge-table__col border-bottom-0 pt-0 border-top-0">
    <ng-container
      [ngTemplateOutlet]="filterInput"
      [ngTemplateOutletContext]="{ label: 'Section', field: 'section' }"
    >
    </ng-container>
  </div>
  <div class="col fge-table__col border-bottom-0 pt-0 border-top-0"></div>
  <div class="col fge-table__col border-bottom-0 pt-0 border-top-0"></div>
</div>
<div class="fge-table">
  <div class="row m-0 fge-table__header">
    <div class="col fge-table__col fge-table-checkbox"></div>
    <div class="col fge-table__col">
      Username
    </div>
    <div class="col fge-table__col">
      First Name
    </div>
    <div class="col fge-table__col">
      Last Name
    </div>
    <div class="col-2 fge-table__col">
      Application
    </div>
    <div class="col-2 fge-table__col">
      Section
    </div>
    <div class="col fge-table__col">
      Activity
    </div>
    <div class="col fge-table__col">
      Activity Date
    </div>
    <div class="col fge-table__col">
      Action
    </div>
  </div>
  <div class="row fge-table__row m-0" *ngFor="let report of (reports$ | async)">
    <div class="col fge-table__col fge-table-checkbox" title="{{ report.id }}">
      <input type="checkbox" class="col-sm-2 fge-table__col"/>
    </div>
    <div class="col fge-table__col" title="{{ report.login }}">
      <span>{{ report.login }}</span>
    </div>
    <div class="col fge-table__col" title="{{ report.firstName }}">
      {{ report.firstName }}
    </div>
    <div class="col fge-table__col" title="{{ report.lastName }}">
      {{ report.lastName }}
    </div>
    <div
      class="col-2 fge-table__col"
      title="{{ report.application | fgeApplicationPath }}"
    >
      {{ report.application | fgeApplicationPath }}
    </div>
    <div class="col-2 fge-table__col" title="{{ report.section }}">
      {{ report.section }}
    </div>
    <div class="col fge-table__col" title="{{ report.actionPerformed }}">
      {{ report.actionPerformed }}
    </div>
    <div class="col fge-table__col" title="{{ report.actionDate }}">
      {{ report.actionDate }}
    </div>
    <div class="col fge-table__col pr-0 fge-table--actions">
      <a class="btn btn-secondary bg-secondary btn-sm mr-2" tabindex="0">
        <i class="fas fa-edit"></i>
      </a>
    </div>
  </div>
  <!--ngb-pagination
    class="d-flex justify-content-center pt-3"
    *ngIf="reportsState?.totalCount > reportsState?.limit"
    [collectionSize]="reportsState?.totalCount"
    [page]="pageNumber"
    [pageSize]="reportsState?.limit"
    [maxSize]="5"
    [rotate]="true"
    [ellipses]="false"
    [boundaryLinks]="true"
    (pageChange)="onPageChange($event)"
    size="sm"
  ></ngb-pagination-->
</div>
<ng-template #filterInput let-label="label" let-field="field">
  <div class="input-group input-group-sm mt-1">
    <div class="input-group-prepend fge-clickable" (click)="onPerformFilter()">
      <span class="input-group-text">
        <i class="fas fa-search"></i>
      </span>
    </div>
    <input
      [(ngModel)]="filters[field]"
      type="text"
      class="form-control"
      placeholder="{{label}}"
      (keyup.enter)="onPerformFilter()"
      (keyup.esc)="onResetFilters()">
  </div>
</ng-template>
